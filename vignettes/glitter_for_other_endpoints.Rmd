---
title: "glitter for other endpoints"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{glitter for other endpoints}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE, message=FALSE, warning=FALSE
)
```

```{r setup}
#remotes::install_github("lvaudor/glitter")
library(glitter)
```

# dataBNF

## Explorer les données

```{r explordata}
tib=add_triplets(t="?s ?p ?o") %>% 
  spq_head(10) %>% 
  send(endpoint="dataBNF")

knitr::kable(tib)
```

## Dates biographiques d'un auteur

```{r dates_biog}
tib=add_triplets(t="?auteur foaf:birthday ?jour") %>% 
  add_triplets(t="?auteur bio:birth ?date1") %>% 
  add_triplets(t="?auteur bio:death ?date2") %>% 
  add_triplets(t="?auteur foaf:name ?nom", required=FALSE) %>% 
  spq_arrange("?jour") %>% 
  spq_prefix() %>% 
  spq_head(n=10) %>% 
  send(endpoint="dataBNF")

knitr::kable(tib)
```

## Toutes les éditions de l'oeuvre Les Fleurs du Mal de Baudelaire

```{r fleurs_du_mal}
tib=add_triplets(t="<http://data.bnf.fr/ark:/12148/cb11947965f> foaf:focus ?Oeuvre") %>% 
  add_triplets(t="?edition rdarelationships:workManifested ?Oeuvre") %>% 
  add_triplets(t="?edition dcterms:date ?date", required=FALSE) %>% 
  add_triplets(t="?edition dcterms:title ?titre") %>% 
  add_triplets(t="?edition dcterms:publisher ?editeur") %>% 
  spq_head(n=20) %>% 
  spq_prefix() %>% 
  send("dataBNF")


knitr::kable(tib)
```

## Lien à un document numérisé dans Galliga

```{r doc_num_gallica}
tib=add_triplets(t="<http://data.bnf.fr/ark:/12148/cb42712156j#about> rdarelationships:electronicReproduction ?URLGallica") %>% 
  add_triplets(t="<http://data.bnf.fr/ark:/12148/cb42712156j#about> dcterms:title ?title") %>% 
  spq_prefix() %>%
  send(endpoint="dataBNF")

knitr::kable(tib)
```

## Expositions virtuelles de la BNF


```{r expo_virtuelles_bnf}
tib=add_triplets(t="?exposition a <http://data.bnf.fr/ontology/bnf-onto/ExpositionVirtuelle>") %>% 
  add_triplets(t="?exposition dcterms:title ?titre") %>% 
  add_triplets(t="?exposition dcterms:subject ?sujet") %>% 
  spq_head(n=30) %>% 
  send(endpoint="dataBNF")

knitr::kable(tib)
```

## Retrouver un nom de personne à partir d'un ISNI

```{r nom_from_isni}
tib=add_triplets(t="?person isni:identifierValid '0000000121012885'") %>% 
  add_triplets(t="?person foaf:focus ?identity") %>% 
  add_triplets(t="?identity foaf:familyName ?nom") %>% 
  add_triplets(t="?identity foaf:givenName ?prenom") %>% 
  send(endpoint="dataBNF")

knitr::kable(tib)
```


## Identifiant ARK d'une notice à partir du numéro FRBNF

```{r ark_from_frbnf}
tib=add_triplets(t="?pidArk bnf-onto:FRBNF '11992081'^^xsd:integer") %>% 
  spq_head(n=10) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Retrouver une oeuvre à partir d'un ISBN

```{r oeuvre_from_isbn}
tib=add_triplets(t="?work rdfs:label ?title") %>% 
  add_triplets(t="?work dcterms:creator ?creator") %>% 
  add_triplets(t="?manifestation bnf-onto:isbn '2-7028-4777-3'") %>% 
  add_triplets(t="?manifestation rdarelationships:workManifested ?work") %>% 
  add_triplets(t="?creator foaf:name ?name") %>% 
  spq_head(n=10) %>% 
  spq_prefix(prefixes=c("bnf-onto"="http://data.bnf.fr/ontology/bnf-onto/")) %>%
  send(e="dataBNF")

kable::knitr(tib)
```

## Tous les auteurs morts avant 1924

```{r auteurs_morts_avant_1024}
tib=add_triplets(t="?oeuvre dcterms:creator ?auteur") %>% 
  add_triplets(t="?auteur bio:death ?mort") %>% 
  add_triplets(t="?auteur foaf:familyName ?nom") %>%
  spq_filter("xsd:integer(?mort)<'1924'^^xsd:integer") %>% 
  spq_group_by(c("?auteur","?nom","?mort")) %>% 
  spq_arrange("desc(xsd:integer(?mort))") %>% 
  spq_head(n=10) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Images dans data.bnf.fr

```{r images_databnf}
tib=add_triplets(t="?image dcterms:type <http://purl.org/dc/dcmitype/StillImage>") %>%
  spq_head(n=10) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```


## Ouvrages adaptés pour la jeunesse

```{r ouvrages_jeunesse}
tib=add_triplets(t="?manifestation bnf-onto:ouvrageJeunesse 'true'^^xsd:boolean") %>% 
  add_triplets(t=". rdarelationships:workManifested ?oeuvre") %>% 
  add_triplets(t=". rdfs:seeAlso ?uri") %>% 
  spq_group_by(c("?uri","?oeuvre")) %>% 
  spq_head(n=10) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Portraits d'auteur, issus de Gallica

```{r}
tib=add_triplets(t="?auteur rdf:type skos:Concept") %>% 
  add_triplets(t=". foaf:focus ?person") %>% 
  add_triplets(t="?doc rdarelationships:electronicReproduction ?url") %>% 
  add_triplets(t=". dcterms:subject ?auteur") %>% 
  add_triplets(t=". dcterms:subject <http://data.bnf.fr/ark:/12148/cb11932843f>") %>% 
  spq_head(n=10) %>% 
  spq_group_by(c("?auteur","?url")) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Termes spécifiques d'un sujet (RAMEAU)

```{r}
tib= add_triplets(t="?sujet1 skos:prefLabel ?label") %>% 
  add_triplets(t=". skos:narrower ?uri2") %>% 
  add_triplets(t="?uri2 skos:prefLabel ?label2") %>% 
  add_triplets(t="?uri2 skos:narrower ?uri3", required=FALSE) %>% 
  add_triplets(t="?uri3 skos:prefLabel ?label3", required=FALSE) %>% 
  spq_head(n=10) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Sujets RAMEAU de type nom commun

```{r}
tib=add_triplets(t="?sujet dcterms:isPartOf <http://data.bnf.fr/vocabulary/rameau/r166>") %>% 
  add_triplets(". skos:prefLabel ?label") %>% 
  spq_head(n=10) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Alignement entre les sujets RAMEAU et lieux

```{r rameau_et_lieux}
tib=add_triplets(t="?c a <http://www.w3.org/2003/01/geo/wgs84_pos#SpatialThing>") %>% 
  add_triplets("?lieu foaf:focus ?c") %>% 
  add_triplets("?lieu skos:closeMatch ?concept") %>% 
  spq_group_by(c("?lieu","?concept","?c")) %>% 
  spq_head(n=100) %>% 
  send(e="dataBNF")

knitr::kable(tib)
```

## Liens vers wikipedia pour les auteurs

```{r}
tib=add_triplets(t="?ConceptA foaf:focus ?auteur") %>% 
  add_triplets("?oeuvre dcterms:creator ?auteur") %>% 
  add_triplets("?ConceptA rdfs:seeAlso ?wikipedia") %>% 
  spq_filter("regex(?wikipedia,'wikipedia')") %>% 
  spq_head(n=10) %>% 
  send(e="dataBNF")
```
